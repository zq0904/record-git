<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Document</title>
  <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
  <style>
    * {
      margin: 0;
      padding: 0;
    }
    html, body {
      width: 100%;
    }
    body {
      display: flex;
      justify-content: center;
      align-items: center;
      background-color: #ccc;
    }
    .box {
      position: relative;
      display: flex;
      flex-wrap: wrap;
      width: 90%;
      height: 50%;
    }
    .box .item {
      flex: 1 1 33.3333333%;
      padding: 2%;
      box-sizing: border-box;
    }
    .item img {
      width: 100%;
      height: 100%;
    }
    /* 结束的状态 */
    img.end {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }

    .asd {
      position: absolute;
      top: 10px;
      left: 10px;
    }
    .qwe {
      position: fixed;
      top: 0;
      left: 0;
    }
  </style>
</head>

<body>
  <div class="box">
    <div class="item"><img src="./images/1.png" alt="" /></div>
    <div class="item"><img src="./images/2.png" alt="" /></div>
    <div class="item"><img src="./images/3.png" alt="" /></div>
    <div class="item"><img src="./images/4.png" alt="" /></div>
    <div class="item"><img src="./images/5.png" alt="" /></div>
    <div class="item"><img src="./images/6.png" alt="" /></div>
    <div class="item"><img src="./images/7.png" alt="" /></div>
    <div class="item"><img src="./images/8.png" alt="" /></div>
    <div class="item"><img src="./images/9.png" alt="" /></div>
  </div>
  <!-- <script src="../node_modules/jquery/dist/jquery.min.js"></script> -->
  <script>
    const imgs = document.querySelectorAll('.box img')
    imgs.forEach(v => handle(v))
    function handle (v) {
      v.addEventListener('click', e => {
        const nowDom = e.target
        const first = nowDom.getBoundingClientRect()
        v.animateInstance && console.log(v.animateInstance, v.animateInstance.startTime)
        v.animateInstance && v.animateInstance.cancel() // 动画在过程中 终止动画 (否则导致结束状态计算会有问题)
        nowDom.classList[nowDom.classList.contains('end') ? 'remove' : 'add']('end')

        const last = nowDom.getBoundingClientRect()
        // last.transformOrigin = window.getComputedStyle(nowDom).transformOrigin
        const translateX = first.left - last.left
        const translateY = first.top - last.top
        const scaleX = first.width / last.width
        const scaleY = first.height / last.height
        // const correctX = last.width * (scaleX - 1) / 2
        // const correctY = last.height * (scaleY - 1) / 2

        v.animateInstance = nowDom.animate({
          transformOrigin: ['left top', 'left top'],
          transform: [ `translate(${translateX}px, ${translateY}px) scale(${scaleX}, ${scaleY})`, 'none']
        }, {
          duration: 2000,
          fill: 'both'
        })
      }, false)
    }
    function describeLog ({ bottom, height, left, right, top, width, x, y, borderColor }) {
      console.log(width, height)
      const div = document.createElement('div')
      div.style = `position:absolute;left:${left}px;top:${top}px;width:${width}px;height:${height}px;border:1px solid red;background-color:transparent;z-index:1;`
      document.querySelector('body').appendChild(div)
    }

  </script>
</body>

</html>