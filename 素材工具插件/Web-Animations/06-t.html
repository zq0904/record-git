<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Document</title>
  <style>
  html,
  body {
    font-size: 14px;
    width: 100%;
    height: 100%;
    margin: 0;
    padding: 0;
  }
  body {
    display: flex;
    flex-direction: row;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    background: #1D1F20;
  }
  *,
  *:before,
  *:after {
    box-sizing: border-box;
    position: relative;
  }

  :root {
    --app-width: 50vmin;
    --app-height: 90vmin;
  }

  .app {
    height: var(--app-height);
    width: var(--app-width);
    background: white;
    overflow: hidden;
  }

  .scene {
    display: flex;
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    max-height: 100%;
    overflow-y: scroll;
  }

  .scene.-gallery {
    flex-direction: row;
    flex-wrap: wrap;
    justify-content: space-around;
    align-items: flex-start;
  }
  .scene.-gallery>.item {
    flex-basis: 30%;
    flex-grow: 0;
    flex-shrink: 0;
    height: auto;
    min-height: var(--app-width)/3;
  }
  .item {
    transform-origin: top left;
  }
  .item>img {
    height: auto;
    width: 100%;
  }
  .detail {
    color: white;
    width: var(--app-width);
    height: var(--app-height);
    transform-origin: top left;
    display: flex;
    flex-direction: column;
  }
  .detail > img {
    height: auto;
    width: 100%;
    height: auto;
    flex: 0 1 auto;
    z-index: 1;
  }
  .detail>.content {
    background: #232323;
    flex: 1 0 auto;
    padding: 2rem 1.5rem;
    animation: slide-down 0.6s ease-in-out;
  }
  @keyframes slide-down {
    from {
      transform: translateY(-100%);
    }
    to {
      transform: translateY(0);
    }
  }
  .detail>.content>* {
    margin-bottom: 1rem;
  }
  .detail>.content>.title {
    font-size: 2rem;
    text-transform: uppercase;
  }
  .detail>.content>.creator {
    opacity: 0.6;
    margin-top: -0.5rem;
  }
  .detail>.content>.description {
    line-height: 1.5;
  }
  </style>
</head>

<body>
  <div class="app">
    <div class="scene -gallery">
      <div class="item" data-key="owl">
        <img src="./images/1.png" alt="" />
      </div>
      <div class="item" data-key="deer">
        <img src="./images/2.png" alt="" />
      </div>
      <div class="item" data-key="hipster">
        <img src="./images/3.png" alt="" />
      </div>
      <div class="item" data-key="ram">
        <img src="./images/4.png" alt="" />
      </div>
      <div class="item" data-key="dog">
        <img src="./images/5.png" alt="" />
      </div>
      <div class="item" data-key="ram-side">
        <img src="./images/6.png" alt="" />
      </div>
      <div class="item" data-key="ram-horns">
        <img src="./images/7.png" alt="" />
      </div>
      <div class="item" data-key="gorilla">
        <img src="./images/8.png" alt="" />
      </div>
      <div class="item" data-key="bird">
        <img src="./images/9.png" alt="" />
      </div>
    </div>

    <div class="scene -detail">
      <div class="detail">
        <img />
        <div class="content">
          <div class="title">大角鸮</div>
          <div class="creator">Krystine洛佩兹</div>
          <div class="description">他们悲伤地坐着，安慰着他们。我爱你，我爱你，我爱你，我爱你，我爱你，我爱你。你的荣誉，你的荣誉，你的荣誉。</div>
        </div>
      </div>
    </div>

  </div>
  <script>
    const items = document.querySelectorAll('.item');
    const detailItem = document.querySelector('.detail');
    const detailScene = document.querySelector('.scene.-detail');
    detailScene.style.display = 'none';

    items.forEach((item) => {
      item.addEventListener('click', () => {
        const itemImage = item.querySelector('img');

        detailItem.setAttribute('data-image', item.getAttribute('data-key'));

        detailItem.querySelector('img')
          .setAttribute('src', itemImage.getAttribute('src'));

        detailScene.style.display = 'block';
        item.style.opacity = 0;

        let firstRect = itemImage.getBoundingClientRect();
        let lastRect = detailItem.getBoundingClientRect();

        // console.log('firstRect', firstRect)
        // console.log('lastRect', lastRect)
        // console.log('translateX', (firstRect.left - lastRect.left))
        // console.log('translateY', (firstRect.top - lastRect.top))
        // console.log('scale', (firstRect.width / lastRect.width))

        detailItem.animate([{
            transform: `
              translateX(${firstRect.left - lastRect.left}px)
              translateY(${firstRect.top - lastRect.top}px)
              scale(${firstRect.width / lastRect.width})
            `
          },
          {
            transform: `
              translateX(0)
              translateY(0)
              scale(1)
            `
          }
        ], {
          duration: 2000
        });
      });
    });

    detailItem.addEventListener('click', () => {
      const itemImage = document.querySelector(`[data-key="${detailItem.getAttribute('data-image')}"]`);
      let itemImageRect = itemImage.getBoundingClientRect();
      let detailItemRect = detailItem.getBoundingClientRect();
      detailScene.style.display = 'none';
      itemImage.style.opacity = 1;

      itemImage.animate([{
          zIndex: 2,
          transform: `
            translateX(${detailItemRect.left - itemImageRect.left}px)
            translateY(${detailItemRect.top - itemImageRect.top}px)
            scale(${detailItemRect.width / itemImageRect.width})
          `
        },
        {
          zIndex: 2,
          transform: `
            translateX(0)
            translateY(0)
            scale(1)
          `
        }
      ], {
        duration: 600,
        easing: 'cubic-bezier(0.2, 0, 0.2, 1)'
      });
    });


    </script>
</body>

</html>